2025-07-19 17:00:50,161 - logger.py:50 - --- Starting training for aspirin ---
2025-07-19 17:00:50,161 - logger.py:50 - Namespace(amp=True, batch_size=64, clip_grad=1.0, contrastive_aug_mask_ratio=0.15, contrastive_loss_weight=0.1, contrastive_mask_token_idx=0, contrastive_prioritize_heteroatoms=False, contrastive_projection_dim=128, contrastive_temp=0.1, cooldown_epochs=10, data_path='data/md17', decay_rate=0.1, delta_frame=3000, device='cuda:0', drop_path=0.0, empp_atom_type_embed_irreps='16x0e', empp_loss_weight=1.0, empp_num_mask=1, empp_pos_pred_num_s2_channels=32, empp_pos_pred_res_s2grid=100, empp_pos_pred_temp_label=0.1, empp_pos_pred_temp_softmax=0.1, empp_prioritize_heteroatoms=True, empp_ssp_feature_dim='16x0e', enable_contrastive=True, epochs=500, exp_name='md17_final_run_20250719_170047', logger=<logger.FileLogger object at 0x7f8da69efb80>, loss='l2', lr=0.0002, max_test_samples=2000, max_train_samples=10000, max_val_samples=2000, min_lr=1e-06, model_name='graph_attention_transformer_nonlinear_l2', molecule_type='aspirin', momentum=0.9, num_basis=128, opt='adamw', opt_betas=None, opt_eps=1e-08, output_dir='outputs/md17_final_run_20250719_170047', patience_epochs=10, pin_mem=True, print_freq=50, radius=7.0, sched='cosine', seed=42, ssp=False, warmup_epochs=10, warmup_lr=1e-06, weight_decay=0.0001, workers=8)
2025-07-19 17:00:50,162 - logger.py:50 - Loading datasets...
2025-07-19 17:00:50,174 - logger.py:50 - Creating model...
2025-07-19 17:00:58,212 - logger.py:50 - Number of params: 3,464,386
2025-07-19 17:01:04,583 - logger.py:50 - Epoch: [0][0/154]	Total Loss: 0.65770	Main MSE (x10^-2): 65.7703	LR: 1.00e-06	Contra_Raw: 4.24315
2025-07-19 17:04:35,367 - logger.py:50 - Epoch: [0][50/154]	Total Loss: 0.66037	Main MSE (x10^-2): 66.0365	LR: 1.00e-06	Contra_Raw: 4.20161
2025-07-19 17:07:43,866 - logger.py:50 - Epoch: [0][100/154]	Total Loss: 0.66050	Main MSE (x10^-2): 66.0504	LR: 1.00e-06	Contra_Raw: 4.19030
2025-07-19 17:10:52,797 - logger.py:50 - Epoch: [0][150/154]	Total Loss: 0.66088	Main MSE (x10^-2): 66.0880	LR: 1.00e-06	Contra_Raw: 4.18449
2025-07-19 17:11:04,095 - logger.py:50 - Epoch: [0][153/154]	Total Loss: 0.66082	Main MSE (x10^-2): 66.0820	LR: 1.00e-06	Contra_Raw: 4.18417
2025-07-19 17:11:04,122 - logger.py:50 - Epoch 0 Training Summary: Avg Total Loss: 0.66082, Avg Main MSE: 0.66082, Time: 605.91s
2025-07-19 17:12:00,109 - logger.py:50 - *** New Best Val MSE (x10^-2): 24.0563, Corresponding Test MSE (x10^-2): 24.2302 at Epoch 0 ***
2025-07-19 17:12:00,153 - logger.py:50 - Epoch 0 Summary | Train MSE (x10^-2): 66.0820 | Val MSE (x10^-2): 24.0563 | Time: 661.94s
2025-07-19 17:12:04,206 - logger.py:50 - Epoch: [1][0/154]	Total Loss: 0.64880	Main MSE (x10^-2): 64.8795	LR: 1.00e-06	Contra_Raw: 4.16661
2025-07-19 17:15:11,511 - logger.py:50 - Epoch: [1][50/154]	Total Loss: 0.65305	Main MSE (x10^-2): 65.3052	LR: 1.00e-06	Contra_Raw: 4.16831
2025-07-19 17:18:19,707 - logger.py:50 - Epoch: [1][100/154]	Total Loss: 0.65436	Main MSE (x10^-2): 65.4358	LR: 1.00e-06	Contra_Raw: 4.16702
2025-07-19 17:21:27,952 - logger.py:50 - Epoch: [1][150/154]	Total Loss: 0.65632	Main MSE (x10^-2): 65.6323	LR: 1.00e-06	Contra_Raw: 4.16610
2025-07-19 17:21:39,244 - logger.py:50 - Epoch: [1][153/154]	Total Loss: 0.65627	Main MSE (x10^-2): 65.6266	LR: 1.00e-06	Contra_Raw: 4.16611
2025-07-19 17:21:39,285 - logger.py:50 - Epoch 1 Training Summary: Avg Total Loss: 0.65627, Avg Main MSE: 0.65627, Time: 579.13s
2025-07-19 17:22:35,395 - logger.py:50 - *** New Best Val MSE (x10^-2): 23.7400, Corresponding Test MSE (x10^-2): 23.9155 at Epoch 1 ***
2025-07-19 17:22:35,442 - logger.py:50 - Epoch 1 Summary | Train MSE (x10^-2): 65.6266 | Val MSE (x10^-2): 23.7400 | Time: 635.29s
2025-07-19 17:22:39,402 - logger.py:50 - Epoch: [2][0/154]	Total Loss: 0.65274	Main MSE (x10^-2): 65.2736	LR: 2.09e-05	Contra_Raw: 4.16461
2025-07-19 17:25:47,453 - logger.py:50 - Epoch: [2][50/154]	Total Loss: 0.63246	Main MSE (x10^-2): 63.2464	LR: 2.09e-05	Contra_Raw: 4.15993
2025-07-19 17:28:56,720 - logger.py:50 - Epoch: [2][100/154]	Total Loss: 0.61435	Main MSE (x10^-2): 61.4354	LR: 2.09e-05	Contra_Raw: 4.15758
2025-07-19 17:32:04,968 - logger.py:50 - Epoch: [2][150/154]	Total Loss: 0.58510	Main MSE (x10^-2): 58.5104	LR: 2.09e-05	Contra_Raw: 3.91740
2025-07-19 17:32:16,289 - logger.py:50 - Epoch: [2][153/154]	Total Loss: 0.58275	Main MSE (x10^-2): 58.2748	LR: 2.09e-05	Contra_Raw: 3.89580
2025-07-19 17:32:16,338 - logger.py:50 - Epoch 2 Training Summary: Avg Total Loss: 0.58275, Avg Main MSE: 0.58275, Time: 580.89s
2025-07-19 17:33:12,353 - logger.py:50 - *** New Best Val MSE (x10^-2): 17.9862, Corresponding Test MSE (x10^-2): 17.8425 at Epoch 2 ***
2025-07-19 17:33:12,401 - logger.py:50 - Epoch 2 Summary | Train MSE (x10^-2): 58.2748 | Val MSE (x10^-2): 17.9862 | Time: 636.96s
2025-07-19 17:33:16,370 - logger.py:50 - Epoch: [3][0/154]	Total Loss: 0.45365	Main MSE (x10^-2): 45.3653	LR: 4.08e-05	Contra_Raw: 2.78171
2025-07-19 17:38:15,138 - logger.py:50 - Epoch: [3][50/154]	Total Loss: 0.40569	Main MSE (x10^-2): 40.5692	LR: 4.08e-05	Contra_Raw: 2.28767
2025-07-19 17:41:22,992 - logger.py:50 - Epoch: [3][100/154]	Total Loss: 0.37540	Main MSE (x10^-2): 37.5401	LR: 4.08e-05	Contra_Raw: 1.96747
2025-07-19 17:44:30,776 - logger.py:50 - Epoch: [3][150/154]	Total Loss: 0.34806	Main MSE (x10^-2): 34.8055	LR: 4.08e-05	Contra_Raw: 1.68111
2025-07-19 17:44:42,059 - logger.py:50 - Epoch: [3][153/154]	Total Loss: 0.34658	Main MSE (x10^-2): 34.6580	LR: 4.08e-05	Contra_Raw: 1.66699
2025-07-19 17:44:42,109 - logger.py:50 - Epoch 3 Training Summary: Avg Total Loss: 0.34658, Avg Main MSE: 0.34658, Time: 689.70s
2025-07-19 17:45:38,354 - logger.py:50 - *** New Best Val MSE (x10^-2): 17.7410, Corresponding Test MSE (x10^-2): 17.5702 at Epoch 3 ***
2025-07-19 17:45:38,401 - logger.py:50 - Epoch 3 Summary | Train MSE (x10^-2): 34.6580 | Val MSE (x10^-2): 17.7410 | Time: 746.00s
2025-07-19 17:45:42,383 - logger.py:50 - Epoch: [4][0/154]	Total Loss: 0.26793	Main MSE (x10^-2): 26.7932	LR: 6.07e-05	Contra_Raw: 0.91475
2025-07-19 17:48:49,295 - logger.py:50 - Epoch: [4][50/154]	Total Loss: 0.26428	Main MSE (x10^-2): 26.4277	LR: 6.07e-05	Contra_Raw: 0.84423
2025-07-19 17:51:57,356 - logger.py:50 - Epoch: [4][100/154]	Total Loss: 0.25522	Main MSE (x10^-2): 25.5223	LR: 6.07e-05	Contra_Raw: 0.77448
2025-07-19 17:55:05,775 - logger.py:50 - Epoch: [4][150/154]	Total Loss: 0.24859	Main MSE (x10^-2): 24.8594	LR: 6.07e-05	Contra_Raw: 0.72354
2025-07-19 17:55:17,078 - logger.py:50 - Epoch: [4][153/154]	Total Loss: 0.24838	Main MSE (x10^-2): 24.8376	LR: 6.07e-05	Contra_Raw: 0.72067
2025-07-19 17:55:17,139 - logger.py:50 - Epoch 4 Training Summary: Avg Total Loss: 0.24838, Avg Main MSE: 0.24838, Time: 578.74s
2025-07-19 17:56:13,165 - logger.py:50 - *** New Best Val MSE (x10^-2): 17.3048, Corresponding Test MSE (x10^-2): 17.1251 at Epoch 4 ***
2025-07-19 17:56:13,213 - logger.py:50 - Epoch 4 Summary | Train MSE (x10^-2): 24.8376 | Val MSE (x10^-2): 17.3048 | Time: 634.81s
2025-07-19 17:56:17,196 - logger.py:50 - Epoch: [5][0/154]	Total Loss: 0.23777	Main MSE (x10^-2): 23.7770	LR: 8.06e-05	Contra_Raw: 0.55922
2025-07-19 17:59:24,084 - logger.py:50 - Epoch: [5][50/154]	Total Loss: 0.23137	Main MSE (x10^-2): 23.1374	LR: 8.06e-05	Contra_Raw: 0.54429
2025-07-19 18:02:31,813 - logger.py:50 - Epoch: [5][100/154]	Total Loss: 0.22649	Main MSE (x10^-2): 22.6493	LR: 8.06e-05	Contra_Raw: 0.52040
